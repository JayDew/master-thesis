# Define a function using lambda
import numpy as np
from matplotlib import pyplot as plt

stock = lambda A, amp, angle, phase: A * angle + amp * np.sin(angle + phase)

pgd = [32.5946105882353, 32.15025058823529, 31.7058905882353, 31.2615305882353, 30.817170588235292, 30.372810588235296, 29.928450588235297, 29.484090588235304, 29.039730588235297, 28.5953705882353, 28.151010588235298, 27.7066505882353, 27.262290588235295, 26.817930588235296, 26.37357058823531, 25.929210588235303, 25.484850588235304, 25.040490588235304, 24.596130588235308, 24.15177058823531, 23.707410588235305, 23.263050588235302, 22.818690588235306, 22.374330588235306, 21.9299705882353, 21.485610588235303, 21.041250588235307, 20.59689058823531, 20.152530588235305, 19.70817058823531, 19.26381058823531, 18.819450588235313, 18.375090588235313, 17.930730588235306, 17.486370588235303, 17.042010588235303, 16.59765058823531, 16.153290588235308, 15.708930588235305, 15.264570588235308, 14.820210588235307, 14.37585058823531, 13.931490588235306, 13.487130588235306, 13.042770588235307, 12.598410588235307, 12.157690514705898, 11.726412827205893, 11.297013003308834, 10.882746116397065, 10.499656618380527, 10.144517242509012, 9.812929654204762, 9.504124058552, 9.208689843924848, 8.923309686844688, 8.642968259872482, 8.37269676395195, 8.110105210441887, 7.8619954172462565, 7.625110825428575, 7.394708286612047, 7.172009881457001, 6.951632223974594, 6.73221588361003, 6.521245202555742, 6.3130428795600695, 6.1049183118911206, 5.896815850531781, 5.692750350043348, 5.498207482874087, 5.323629267839562, 5.171352437058087, 5.0279650228853265, 4.892008886231028, 4.7719016433953145, 4.6566731579199825, 4.545241915790506, 4.437409632724606, 4.332953535998571, 4.228892989267273, 4.12700899685977, 4.0319374391790594, 3.9413769097788265, 3.8532379227025824, 3.765048368244233, 3.6768861313074646, 3.5887532748870514, 3.501911457474848, 3.4211134443327134, 3.34728909865725, 3.2746407666773725, 3.203129701787342, 3.135621716911489, 3.0672113329552113, 2.9991032189881586, 2.9350254323342444, 2.873579618352202, 2.813623503450309, 2.7546341884856456, 2.6962691815868496, 2.638308185757181, 2.582523293207862, 2.52784654730062, 2.4732444811384946, 2.418624774319004, 2.3639844676763158, 2.309332386284018, 2.254675126556733, 2.200016223749386, 2.1453572726596115, 2.091584270817151, 2.0398160478452136, 1.9893297586803576, 1.941625829151071, 1.8966404234936338, 1.8545691378754734, 1.8130319281417207, 1.771553470528114, 1.7301126181868645, 1.6886885932009776, 1.6490991314153456, 1.609522105082951, 1.5703644321220078, 1.5324912842502176, 1.4948276028380192, 1.4589175950677562, 1.4240083585808099, 1.390589849059252, 1.3612507428981673, 1.3334927293993848, 1.3060529133806407, 1.2786809231352743, 1.2514669362146034, 1.2260289173066885, 1.2017797147788765, 1.1794135349246166, 1.1586891943775002, 1.1382750703001165, 1.1179588881392921, 1.0976617669664543, 1.0773554418482827, 1.057031789125961, 1.036690478376084, 1.0163338590133213, 0.995964867511676, 0.9755862279183343, 0.955200204843747, 0.9348085827075403, 0.9150048219757231, 0.8962614107575257, 0.8791908659509272, 0.8625896439365386, 0.8461862319442486, 0.8298878513907276, 0.8136418058603013, 0.7974180198260645, 0.7811995226954441, 0.7652298935419802, 0.7497252220545735, 0.7347787146536153, 0.7216362775302431, 0.7084505985267215, 0.6953086241394443, 0.6822241208387287, 0.6691911137917353, 0.6562002319788848, 0.6432430883466507, 0.6303130269202553, 0.6174049125763013, 0.6045147682958131, 0.5928108433552637, 0.5833819570040972, 0.57361391523997, 0.5636041279234021, 0.5534132811856689, 0.5430826005616481, 0.532641802026118, 0.5221131289871807, 0.5115136341396971, 0.5008566012122659, 0.49015249934614585, 0.47940965690339754, 0.4686347527416942, 0.4578331818429535, 0.4470093312461131, 0.4361667904633779, 0.42530851332283814, 0.4144369434184161, 0.40355411206730263, 0.392661715348252, 0.38176117511417956, 0.3708536876457432, 0.3599402627096995, 0.3490217551173819, 0.3382909810271554, 0.32780055541093595, 0.31863979752989025, 0.31019251945350385, 0.3023936428350633, 0.29480294871955043, 0.28726064833408005, 0.27976522208148136, 0.27247067719627127, 0.2657090306011915, 0.2596023172848652, 0.2538379419245804, 0.24830600926719792, 0.2429448637079769, 0.2377102371318358, 0.23257017558757093, 0.22758127817676577, 0.22285209171228798, 0.21836998152670326, 0.21417611361676028, 0.2111337695954345, 0.20794294257780457, 0.20464485177977648, 0.20127019311988525, 0.19784185103868376, 0.19437687926175246, 0.19088796102338682, 0.18738449358448736, 0.18387339855391693, 0.18035973027299732, 0.1768471343690786, 0.1733381944538366, 0.16983469488857245, 0.16633782029806998, 0.1628483072461061, 0.15936655961951687, 0.1561156550874919, 0.15317047121969551, 0.15038329660860292, 0.14827734335132134, 0.1462125908913759, 0.144182316120202, 0.14218508645919023, 0.140221041138313, 0.13829030424585215, 0.13639243974035176, 0.13452638045910892, 0.13269054479753287, 0.13106850918825413, 0.12973917050458017, 0.12837590431998372, 0.12698640876027537, 0.12557655110158053, 0.1241508255520795, 0.122712692799977, 0.12126483229933568, 0.11980933018223476, 0.11834781965662303, 0.11688158628637565, 0.11541164726323233, 0.11393881136726466, 0.11246372454404545, 0.11098690473146178, 0.10950876862020627, 0.10802965233619546, 0.10655033068601938, 0.10507124143483307, 0.10359236179570572, 0.10211367806019608, 0.10063518307211732, 0.09915687392025564, 0.09767875010319446, 0.09620081219434529, 0.0947230609424373, 0.0932454967150161, 0.09176811919455913, 0.09029092725052917, 0.08881391892719162, 0.08733709150246687, 0.08586044158594737, 0.0843839652342967, 0.0829076580697965, 0.0814315153932544, 0.0799555322863149, 0.07847970370080445, 0.07700402453443399, 0.07552848969324068, 0.07405309414176638, 0.07257783294227448, 0.0711027012844291, 0.06962769450685007, 0.06815280811187374, 0.06667803777472807, 0.06520337934819681, 0.06372882886369358, 0.06225438252954623, 0.06078003672715185, 0.0593057880055611, 0.05783163307494565, 0.056357568799316145, 0.05488359218879507, 0.053409700391669104, 0.051935890686413695, 0.05046216047382736, 0.048988507269378714]
fista = [32.5946105882353, 32.15025058823529, 31.594800588235298, 30.928260588235297, 30.1506305882353, 29.261910588235295, 28.262100588235302, 27.1512005882353, 25.929210588235296, 24.596130588235308, 23.151960588235305, 21.596700588235297, 19.930350588235306, 18.1529105882353, 16.26438058823531, 14.26476058823531, 12.157690514705898, 10.121669792956668, 8.495142457273134, 7.135153895256087, 5.925824491765569, 4.9356458823381875, 4.263306871459408, 3.662777826655468, 3.119826008583787, 2.683395083634518, 2.2736708515030206, 1.8933491793022872, 1.5746514557216116, 1.3100111650849746, 1.1147514260613391, 0.956996628533463, 0.8055608161987332, 0.6756243908975565, 0.5757504597577634, 0.47886147170780274, 0.37148559448819707, 0.28192431562032744, 0.21213327473181795, 0.1647625962861427, 0.1363582257271992, 0.11467347769269012, 0.10044712914662354, 0.09179857463999894, 0.08137766506904498, 0.07049370060036984, 0.060381625829599064, 0.047910150783836765, 0.033033438130073776, 0.017631534142806264, 0.0033828481640338654, -0.004709957637393354, -0.00918328212407945, -0.01194938456986057, -0.011409958289969654, -0.01054445729726376, -0.009893948716395621, -0.009863781946526477, -0.00955955552458994, -0.004419405164149737, -0.0004729293276890403, 0.0015051305825980923, 0.0013790892209554534, -0.0006607442050168669, -0.004184887688629313, -0.008631790414401345, -0.013550856201964102, -0.018543816520563725, -0.023316957233965162, -0.02769342359443841, -0.03159566083698723, -0.03500894378106021, -0.037948130483863286, -0.04043556407094705, -0.04249250759868647, -0.04414185315603823, -0.04493134387497979, -0.044646720967000585, -0.04103703139673677, -0.03777756564539433, -0.034912621816740805, -0.03271273729919265, -0.03128819966191731, -0.030634296947344306, -0.030709677805087748, -0.0314505848667869, -0.03277795640979645, -0.03459918982247204, -0.0368075013944117, -0.03928183672911742, -0.04188945312241919, -0.04449201757226926, -0.04695476246303881, -0.04915724923746117, -0.05100379846333571, -0.05243168702513025, -0.053415694342745346, -0.0539676561745551, -0.054122035326637695, -0.053948252138884725, -0.05354278617879724, -0.05301598216711495, -0.05247827414341841, -0.05202802368285141, -0.051742512976394754, -0.05165553975788818, -0.05170765432389982, -0.05192340769382418, -0.05233420854327937, -0.052923663295190104, -0.0536667723695187, -0.05453339432265903, -0.05549131470128146, -0.05650875690672454, -0.057556282164382154, -0.05860810533293262, -0.05942918501865373, -0.05696670606419474, -0.054890727363282404, -0.052957060685582244, -0.05187457115066335, -0.05150751589739291, -0.051642024642780504, -0.0520443323262599, -0.052510347391476676, -0.052898898308335995, -0.053145685136615085, -0.05325924060643003, -0.053303342010067506, -0.05337195342570249, -0.05356292420128801, -0.053955615210020326, -0.05459582648239886, -0.055466027871377534, -0.05651156561894034, -0.057654786938420154, -0.0588073408374915, -0.05988259382559752, -0.06080629384858039, -0.061524253139178996, -0.06200649491587479, -0.062247907740245016, -0.06226590556469033, -0.062095873508328334, -0.061785295278787566, -0.06138743634412263, -0.06095533677877551, -0.06053668990690157, -0.060169983152378474, -0.059882083207916784, -0.05968727696240465, -0.05958764265141703, -0.05957452622172522, -0.05963083545978803, -0.059733835993210666, -0.05985813443204247, -0.05997855960956688, -0.060072697721429924, -0.06012289557611972, -0.060117612498431665, -0.06005207006206118, -0.05992821443419009, -0.05975406392346403, -0.05954256043371346, -0.05931007518252079, -0.05907473481977502, -0.05885473395226187, -0.05866678536841263, -0.05851951764594494, -0.05842418809822861, -0.058393455292493124, -0.05842906892344293, -0.05852840102704787, -0.05868516889901213, -0.05889035092459844, -0.059133171270570065, -0.05940205304088513, -0.05968546860024513, -0.059972643952636503, -0.06025409731725716, -0.06052200881612744, -0.060770428887920294, -0.06099533925679649, -0.061194583940295436, -0.06136769048186106, -0.06151560424631133, -0.061640361349839, -0.061744728132359185, -0.06183183624374067, -0.06190484166918201, -0.0619666329319022, -0.06201960830427713, -0.06206553461094371, -0.06210549194798866, -0.06213990036937337, -0.062168617275389484, -0.06219108865200821, -0.062206533924237396, -0.06221414313136615, -0.06221326622924629, -0.06220357716634057, -0.06218519942861617, -0.06215878443563253, -0.06212553897774096, -0.062087202392799204, -0.06204597808987282, -0.06200442715067567, -0.06196533398450247, -0.06193155535498588, -0.061905864559174115, -0.061890802174523724, -0.061888543676304746, -0.061900792471483196, -0.06192870462942355, -0.06197284897935121, -0.06203320348099945, -0.06210918606660238, -0.06219971570843567, -0.062303297476268664, -0.06241812396387198, -0.06254218477729413, -0.06267337581725674, -0.0628096008115561, -0.0629488588552277, -0.06308931344096995, -0.06322934042342065, -0.06336755436215202, -0.06350281454485984, -0.06363421354862024, -0.06376105234017825, -0.06388280658256396, -0.06399908899227537, -0.06410961231282913, -0.06421415680886694, -0.06431254523952473, -0.064404627154506, -0.06449027318808026, -0.0645693789138904, -0.06464187685932078, -0.06470775453203234, -0.06476707582711244, -0.06482000297851996, -0.06486681628557403, -0.06490792915472705, -0.064943896502407, -0.06497541520810333, -0.06500331602406399, -0.06502854707453205, -0.06505214975371393, -0.06507522840695756, -0.06509891561544127, -0.06512433517666583, -0.06515256497168434, -0.06518460184011567, -0.06522133036315585, -0.06526349711091438, -0.06531169147865303, -0.06536633375596299, -0.0654276705832201, -0.06549577748781947, -0.065570567790454, -0.06565180685356399, -0.0657391304259494, -0.06583206572632146, -0.06593005390239777, -0.06603247259129512, -0.066138657475347, -0.06624792195437375, -0.06635957431761492, -0.0664729320722009, -0.0665873333477618, -0.06670214552909559, -0.0668167714555137, -0.06693065365637514, -0.06704327716264637, -0.06715417144462693, -0.06726291198163803, -0.06736912187984036, -0.06747247383173077, -0.06757269256923948, -0.06766955781617025, -0.06776290760868028, -0.06785264173649613, -0.06793872497190906, -0.06802118970439001, -0.06810013758860958, -0.0681757398419873, -0.06824823589077222, -0.06831793015460995, -0.06838518687018853, -0.06845042297537815, -0.06851409919648485, -0.06857670959350332, -0.06863876991347298, -0.06641660096758298, -0.06361412382356946, -0.06103869329904382, -0.058741156538337023, -0.0567543728776157, -0.05509620769424305]


x = np.arange(max(len(fista), len(pgd)))  # x-axis

# Create main container with size of 6x5
fig = plt.figure(figsize=(6, 5))

# Create first axes, the top-left plot with green plot
# sub1 = fig.add_subplot(2, 2, 1)  # two rows, two columns, fist cell
# sub1.plot(np.arange(len(fista)), fista, color='red')
# sub1.plot(np.arange(len(pgd)), pgd, color='blue')
# sub1.set_xlim(200, 245)
# sub1.set_ylim(0, .4)
# sub1.set_ylabel(r'$ \frac{|f(x_k) - f^{*}|}{|f^{*}}$', labelpad=15)

# Create second axes, a combination of third and fourth cell
# sub2 = fig.add_subplot(2,2,2) # two rows, two columns, second cell
# sub2.plot(np.arange(len(fista)), fista, color='red')
# sub2.plot(np.arange(len(pgd)), pgd, color='blue')
# sub2.set_xlim(350, 2500)
# sub2.set_ylim(-.06, .01)
# sub2.set_ylabel(r'$ \frac{|f(x_k) - f^{*}|}{|f^{*}}$', labelpad=15)

# Create third axes, a combination of third and fourth cell
sub3 = fig.add_subplot(2, 2, (3, 4))  # two rows, two colums, combined third and fourth cell
sub3.plot(np.arange(len(pgd)), pgd, color='blue', alpha=.7, label='PGD')
sub3.plot(np.arange(len(fista)), fista, color='red', alpha=.7, label='APGD')
sub3.set_xlim(0, 300)
sub3.set_ylim(0, 33)
sub3.set_xlabel(r'k-th iteration', labelpad=15)
sub3.set_ylabel(r'$ \frac{|f(x_k) - f^{*}|}{|f^{*}|}$', labelpad=15)

# Create blocked area in third axes
# sub3.fill_between((200, 245), 0, 34, facecolor='blue', alpha=0.2)  # blocked area for first axes
# sub3.fill_between((350, 2500), 0, 34, facecolor='blue', alpha=0.2)  # blocked area for first axes

sub3.legend()
# Save figure with nice margin
plt.savefig('zoom_effect_2.png', dpi=300, bbox_inches='tight', pad_inches=.1)
