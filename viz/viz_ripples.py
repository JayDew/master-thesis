import numpy as np
import matplotlib.pyplot as plt

y = [32.5946105882353, 31.7058905882353, 30.372810588235296, 28.5953705882353, 26.373570588235307, 23.707410588235305, 20.59689058823531, 17.04201058823531, 13.042770588235317, 9.131573897058837, 6.19827286764707, 4.335359856617651, 3.32435904816177, 2.5674420281985286, 1.8625517930147089, 1.2878447864801634, 0.9071223780123975, 0.6610117968531927, 0.5505477706304014, 0.45638184173857443, 0.36889545882562763, 0.30312489281509264, 0.23125197029663708, 0.19370334756870983, 0.1774117728673159, 0.17822418791695577, 0.1723738030511828, 0.1557370011489216, 0.13398157343552905, 0.1216625733755314, 0.10843775000333246, 0.09452326461267756, 0.07540679562881536, 0.06776743760825751, 0.06984870974390699, 0.0649192583908294, 0.06225337290689063, 0.06075553134384727, 0.055860070958087586, 0.05121065302748667, 0.04794159828821395, 0.045874418732486745, 0.045315428130836215, 0.0452344760893373, 0.04398797593630544, 0.0402227198005797, 0.03335966373956618, 0.0246042854380931, 0.014865801270170878, 0.005449332214100162, 0.0020782820723472557, 0.00045577480349249177, -0.004414596156361149, -0.012193168897344845, -0.022301092353172267, -0.034127313622885055, -0.03950989190148616, -0.0376931068776854, -0.036849352391103825, -0.0380082576042385, -0.03668462581949495, -0.022654843007406434, -0.01074342427905752, -0.00611637941653953, -0.008253838554688328, -0.012882493692711413, -0.019474411454348688, -0.026826897142055706, -0.03329911534257716, -0.03961452103360982, -0.04574580101290175, -0.05152039773854005, -0.05633835335145843, -0.05960986330437672, -0.06256889526242251, -0.06522272634168653, -0.06750714525417265, -0.06924759781206191, -0.07028197519163715, -0.07028340143010806, -0.06906195897695735, -0.06689952591502113, -0.06435277438888885, -0.06202609459383237, -0.05994040085595596, -0.057588763473209695, -0.055850444870760185, -0.05484702841312483, -0.05460598698931625, -0.0550671511055135, -0.056093577747906916, -0.05752282732916716, -0.059119522928989914, -0.0605211396994933, -0.06154237906452152, -0.0622450081877565, -0.06252467928142892, -0.06253811310460247, -0.062334657222831547, -0.061973728555527595, -0.061515930113422296, -0.06101820295358539, -0.06053227832254999, -0.06010506034067047, -0.0597794694323779, -0.05959460370516321, -0.0595846462198116, -0.05977656061813629, -0.06018710930793843, -0.060819995414754004, -0.06166394439953665, -0.06269234106499741, -0.06318363453487183, -0.062331830646488215, -0.061990990939733176, -0.06216109616469388, -0.06274769301106134, -0.06359086535018608, -0.06450127750305346, -0.06519631134749006, -0.06550219726625581, -0.06548775305074261, -0.0651153259306301, -0.06441312569129241, -0.06346569286332514, -0.06239705991706077, -0.061350075234016734, -0.060465433574074766, -0.059863455858630114, -0.05963076311077925, -0.05981291096959615, -0.06040837108541866, -0.0613636787413027, -0.06259814409026401, -0.064014567408697, -0.06550977571668488, -0.06698400120072394, -0.06834851707506458, -0.06953127770044072, -0.07048054496816229, -0.07116662225492225, -0.07158188264195493, -0.07173930113299687, -0.07166971126488896, -0.0714180253276034, -0.07103869202163918, -0.07059071112209506, -0.06521504675837039, -0.059445701256913334, -0.054175187169585366, -0.04950528625250281, -0.045503554146115524, -0.04220847862069063, -0.0396355153372684, -0.0377827213174225, -0.03663515161909124, -0.036167677458164856, -0.03634631875759077, -0.03712849111471428, -0.03846271777998044, -0.03992010789445769, -0.04160463286193473, -0.04361670396227921, -0.045857372863466764, -0.048230099011663814, -0.050664195981322366, -0.05311252612392871, -0.05554876562992478, -0.05796235314816969, -0.060352299701016174, -0.0627212387151143, -0.06507070226271364, -0.06737734018489039, -0.0695924988864442, -0.0715535376190477, -0.07313642450237842, -0.07426385228875511, -0.07490643760335972, -0.075077874070146, -0.0748277409368382, -0.0741549888099023, -0.07309645898548045, -0.07174909810332174, -0.07024778517502508, -0.06874325854190054, -0.0673785878441533, -0.06626960391243548, -0.06549215217890805, -0.06507724004625182, -0.06501350743522766, -0.06525526111792548, -0.06573371560868711, -0.06636906092629105, -0.06708139988035894, -0.0677992733244961, -0.06846522387932782, -0.06903847732506971, -0.06949524911187369, -0.06982738212903282, -0.0700400190946439, -0.07014887313845165, -0.06926537186663223, -0.06774778454653643, -0.06646694512372123, -0.06551148261312043, -0.06490263846660216, -0.06460592126970109, -0.06454933462107328, -0.06464383926379082, -0.06476658466563127, -0.06486816349166012, -0.06491345463768189, -0.06487707525043952, -0.06476270882514529, -0.06459670882760993, -0.06441931088179483, -0.0642753856513011, -0.06420631241398207, -0.06424400346184894, -0.0643969232304657, -0.06465692508019086, -0.06500577687526074, -0.0654185142677175, -0.06586685652937643, -0.06632225920443649, -0.06675837413591001, -0.06715284689496973, -0.06748848498903198, -0.06775387766548564, -0.06794355342873443, -0.06805774442091624, -0.06810180672856138, -0.06808533604774258, -0.06802102473095181, -0.06792332722403734, -0.0678070289410013, -0.06768583888987463, -0.06757113961672821, -0.06747102305156549, -0.06738971575081762, -0.06732745449197938, -0.06728081951960722, -0.067243476458701, -0.06720722786516131, -0.06716323914992707, -0.06710328623728191, -0.06702087564589518, -0.06691211031472415, -0.06677621227786273, -0.06661566017783116, -0.06643594872686578, -0.06624502195600733, -0.06605246696535888, -0.06586857624262166, -0.0657033929133088, -0.0655658451062911, -0.0654630553696057, -0.0653998824795622, -0.06537872046832614, -0.06539954770870333, -0.06546019135109053, -0.06555675222091185, -0.06568412410241538, -0.06583653946312751, -0.0660080801913713, -0.06619310494192628, -0.06638656172584045, -0.06658417275402914, -0.06678249574711322, -0.06697887994506135, -0.06717134457605332, -0.06735841204095504, -0.06753892774817594, -0.06771189421271206, -0.06787633993925096, -0.0680312351453729, -0.06817545790441629, -0.06830780692762574, -0.06842705174080918, -0.06853200781896315, -0.06862162331320786, -0.06869506501048302, -0.06875179356778847, -0.06879162122560283, -0.0688147485142656, -0.06882177941548599, -0.06881371668662088, -0.06879194044157903, -0.06875817362628504, -0.0687144378814257, -0.06866300268654785, -0.06860632988953634, -0.06854701498159761, -0.0684877259552773, -0.06843114037402052, -0.06837988139262266, -0.06689396521286346, -0.06463415529191001, -0.062497878716209807, -0.060529795423128245, -0.05876241462406723, -0.05721777620040774, -0.05590972767384753, -0.05484621189393876, -0.05403113330871555, -0.05346556717282232, -0.0531482692678164, -0.053075598207932936, -0.05324105844308219, -0.05363470569341335, -0.05417816690082233, -0.05488839452145681, -0.05577288859298816, -0.05681025883799005, -0.057976318934106444, -0.05924512013425426, -0.06059014534180385, -0.06198546881676325, -0.06339902707106655, -0.06479885823239873, -0.0661571072581612, -0.06745068680798466, -0.06866129011421146, -0.06971957859585404, -0.07055075020213554, -0.07111453654881635, -0.07140383809604005, -0.07143953548548426, -0.0712630141272562, -0.07092791102758689, -0.07049232946086359, -0.07001237241072049, -0.06953742182855503, -0.06910721935268593, -0.06875053614389065, -0.06848507313750532, -0.06831819850295773, -0.06824817764132053, -0.06826564534358723, -0.06835517362164033, -0.06849687429177026, -0.06866802670935022, -0.0688447346318202, -0.06900359877616534, -0.06912335642081172, -0.06918640168721503, -0.06918007350166758, -0.06909759180500284, -0.06893853971514913, -0.06870882777090138, -0.06842012937039332, -0.06808883478254918, -0.06773462489339575, -0.06737880676701714, -0.06704257547965732, -0.06674536822705794, -0.0665034584787757, -0.06632890382695197, -0.06622891687762208, -0.06620568054984378, -0.06625658368555536, -0.06637481500571951, -0.06655022658051682, -0.06677036364032579, -0.06702155548973454, -0.06728997080789595, -0.06756255707363286, -0.06782780515565481, -0.06807630321736964, -0.06830106638708161, -0.06849764818433901, -0.06866405526951065, -0.06880049820651755, -0.06890901768851396, -0.06899302856121615, -0.06905682368317718, -0.06910507692324476, -0.06914238007556005, -0.06917284270247848, -0.0691997772892796, -0.06922548490265884, -0.06925114903170779, -0.06927683770816158, -0.06930160665380276, -0.06895672828078314, -0.06786255895753414, -0.06683109739624908, -0.06588249548714277, -0.06502973331319135, -0.06427959861987442, -0.06363407582435573, -0.06309181876735635, -0.06264945074803402, -0.06230253425964036, -0.06204615598661047, -0.061875159858643176, -0.06178411991065607, -0.06176717132419112, -0.06181781537534192, -0.061928789902129674, -0.06209206122085534, -0.06222848197103554, -0.062372738979251725, -0.06256170192506888, -0.06278785682348426, -0.06304375574497895, -0.06332246128374183, -0.06361382307254768, -0.06390961376195715, -0.06420440959751413, -0.06449583578669436, -0.06478424153831043, -0.06507196666662353, -0.06536240662706953, -0.06565907806149215, -0.0659648441773381, -0.06628139536896845, -0.06660901268008089, -0.06694658414111387, -0.06729180556136323, -0.06764148104212667, -0.06799184225241577, -0.06833882385129521, -0.06867825829439976, -0.06900597981504512, -0.06931650340621186, -0.06958467715353767, -0.06979325492436735, -0.06993316627664595, -0.07000262730587264, -0.0700055283227981, -0.06994954918653687, -0.06984438281451201, -0.06970032417244454, -0.0695273411731567, -0.06933461627299539, -0.06913045474109518, -0.06892240776156011, -0.06871745495940651, -0.06852212240382842, -0.06834246450961831, -0.06818389622290134, -0.06805091213385908, -0.06794676254406001, -0.0678731689368227, -0.0678301535233975, -0.06781603412173552, -0.06782760335384139, -0.06786047737550363, -0.06790957055692877, -0.0677295033975482, -0.06708845914383985, -0.06643310554262255, -0.06578243670445198, -0.06515295996437838, -0.06455872654388817, -0.06401165086173029, -0.06352194142323754, -0.06309849144190907, -0.06274912576989129, -0.062480657897198706, -0.06229876393623378, -0.0622077205823959, -0.06221007656832847, -0.06230633199180602, -0.062494690292704665, -0.0627709286670363, -0.06312840986727425, -0.06355823646669859, -0.06404953114597192, -0.06458981509403744, -0.0651654513683915, -0.06576212007058464, -0.06636529588814648, -0.0669607042347128, -0.06753473842507877, -0.06807482603090342, -0.06856973724142346, -0.06900983157998945, -0.06935761554993981, -0.06958828773798753, -0.06969438385452091, -0.0696838152611664, -0.06957618674407395, -0.06939827796888874, -0.06917951635239979, -0.06894808736714646, -0.06872808068529439, -0.06853781502137286, -0.06838926740320443, -0.06828838266652368, -0.06823596608745215, -0.06822885968002665, -0.06826115285705386, -0.06832525760565034, -0.06841276411245294, -0.06851506655417694, -0.06841029166991508, -0.06807459063466435, -0.06773523594067064, -0.06740062381539084, -0.06707685735189325, -0.06676803227251034, -0.06647672544219632, -0.06620454767311677, -0.06595264526565568, -0.06572207279383517, -0.06551400234063098, -0.06532977285294785, -0.06517081159023519, -0.06503847520124328, -0.06493386119471095, -0.06485763404473488, -0.06480989757758447, -0.06479013043698349, -0.06479718750696631, -0.0648293593208594, -0.06488447468137991, -0.06496002893557172, -0.06505332086461275, -0.06516158388940273, -0.06528210114939877, -0.06541229806006106, -0.0655498095637171, -0.06569252213597732, -0.0658385926203199, -0.0659864472218137, -0.06613476465196759, -0.06628244763774033, -0.06642858691249053, -0.06657242147783272, -0.06671329841715339, -0.06685063489928786, -0.06698388428761834, -0.067112507532843, -0.06723595035363562, -0.06735362617122596, -0.06746490441440474, -0.06756910367000867, -0.06766548920082999, -0.06775327453276404, -0.06783162704717807, -0.06789967771836078, -0.06795653523750937, -0.06800130471956077, -0.06803311098853601, -0.06805112610800226, -0.068054600420956, -0.06804289595830827, -0.06801552073758481, -0.06797216225985343, -0.06791271845575989, -0.06783732443513181, -0.06774637363665026, -0.06764053231252752, -0.06752074666590874, -0.06738824233451707, -0.06724451624150267, -0.06709132108835891, -0.06693064293847809, -0.06676467244367187, -0.06659577032217837, -0.0664264277333964, -0.06625922223855309, -0.06609677010734995, -0.06594167583691568, -0.0657964798874351, -0.06566360579385101, -0.06554530796247547, -0.0654436215793124, -0.06536031611896262, -0.06529685393047104, -0.06525435527938876, -0.06523357104380105, -0.06523486400607581, -0.06525819936967657, -0.06530314478500021, -0.06536887981534178, -0.06545421443823528, -0.0655576158792174, -0.06567724282959742, -0.06581098591562802, -0.06595651316571238, -0.06611131916153944, -0.06627277655079186, -0.06643818863340745, -0.06660484179961071, -0.06677005668614075, -0.06693123701903894, -0.06708591522112783, -0.06723179397635783, -0.06736678306006931, -0.0674890308639439, -0.06759695016780315, -0.06768923783832, -0.06776488826739362, -0.06782320049968964, -0.06786377913773603, -0.06788652925087035, -0.06789164564724255, -0.06787959699135412, -0.06785110535857013, -0.0678071219083115, -0.06774879942565615, -0.0676774625243619, -0.06759457632167913, -0.06750171438691097, -0.06740052673291169, -0.0672927085651315, -0.06717997042981218, -0.06706401031544056, -0.06694648816385562, -0.06682900314370557, -0.06671307393333781, -0.06660012215634398, -0.06649145901410047, -0.06638827506838668, -0.06629163304568716, -0.06620246346468646, -0.06612156283086545, -0.06604959409773248, -0.06598708906334598, -0.0659344523533699, -0.06589196663758615, -0.06585979873486218, -0.06583800628108935, -0.06582654466428085, -0.06582527396936445, -0.06583396572045462, -0.06585230925861307, -0.06587991764623911, -0.06591633304310876, -0.06596103155156662, -0.0660134275773981, -0.06607287779654533, -0.0661386848544217, -0.06621010095272005, -0.06628633149729565, -0.06636653898928661, -0.06644984733991516, -0.06653534677756552, -0.06662209949440434, -0.0667091461499511, -0.06679551331194614, -0.06688022187218401, -0.06696229642846711, -0.06704077557539175, -0.06711472299828421, -0.06718323921817874, -0.06724547379311296, -0.06730063774387673, -0.06734801594211813, -0.06738697917656707, -0.06741699559993129, -0.06743764125529218, -0.06744860938677799, -0.06744971825478885, -0.06744091720063745, -0.06742229073844395, -0.06739406049245712, -0.06735658484451675, -0.0673103562077066, -0.06725599589693294, -0.06719424662359476, -0.06712596269813928, -0.06705209807951963, -0.06697369246290501, -0.06689185564501934, -0.06680775044893844, -0.06672257452594052, -0.06663754138019104, -0.06655386098192358, -0.06647272034590343, -0.06639526445408235, -0.06632257789447911, -0.06625566757270139, -0.06619544682861607, -0.06614272125917713, -0.0660981765101993, -0.06606236825596061, -0.0660357145371222, -0.06601849057581213, -0.06601082613321238, -0.06601270542093568, -0.0660239695242647, -0.06604432124422399, -0.06607333221767153, -0.06611045213124978, -0.06615501980701488, -0.06620627590568925, -0.06626337696830706, -0.06632541049894612, -0.06639141078044793, -0.06646037511150152, -0.06653128015701505, -0.06660309811391919, -0.06667481241091788, -0.06674543268251842, -0.0668140087841648, -0.06687964364554944, -0.06694150479228757, -0.06699883440109744, -0.0670509577895059, -0.06709729027691518, -0.06713734238877589, -0.06717072340876766, -0.06719714331460439, -0.06721641316073654, -0.06722844399535861, -0.06723324441938458, -0.06723091691122055, -0.06722165305317272, -0.06720572780321402, -0.0671834929597711, -0.06715536996745479, -0.06712184220859933, -0.06708344691954254, -0.0670407668622417, -0.06699442187162831, -0.066945060387553, -0.06689335106783843, -0.06683997456630643, -0.06678561554717564, -0.06673095499532898, -0.0666766628710013, -0.06662339114768698, -0.0665717672637389, -0.06652238801133091, -0.06647581388122958, -0.06643256387812786, -0.06639311081903981, -0.06635787712625157, -0.06632723112637544, -0.0663014838678787, -0.066280886470791, -0.06626562802380634, -0.06625583404541423, -0.06625156552669927, -0.06625281857379228, -0.06625952466738927, -0.0662715515550944, -0.06628870478944189, -0.06631072992022963, -0.06633731534422982, -0.06636809580845045, -0.06640265655502772, -0.06644053808665586, -0.06648124152143949, -0.06652423449540923, -0.06656895755998139, -0.06661483101066883, -0.06666126207269303, -0.06670765235916028, -0.06675340550845409, -0.06679793489980031, -0.06684067133986105, -0.06688107060895826, -0.06691862075333453, -0.06695284900987473, -0.06698332825204227, -0.0670096828504643, -0.06703159384859933, -0.06704880336316149, -0.06706111813029297, -0.06706841213167702, -0.0670706282495944, -0.06706777891605664, -0.0670599457382439, -0.06704727810017568, -0.06702999075845702, -0.06700836046767979, -0.06698272168822339, -0.06695346144542214, -0.06692101342398897, -0.06688585139488236, -0.06684848208320696, -0.06680943759499644, -0.06676926752767731, -0.06672853089351005, -0.06668778798730056, -0.06664759232914395, -0.06660848280997514, -0.06657097616233616, -0.06653555987120896, -0.06650268563020051, -0.06647276343703368, -0.06644615640949059, -0.06642317638896568, -0.0664040803839269, -0.06638906789019373, -0.06637827910933733, -0.06637179407101795, -0.06636963265000058, -0.06637175545420991, -0.0663780655467618, -0.06638841095266577, -0.06640258788999735, -0.06642034465598018, -0.0664413860906407, -0.0664653785346393, -0.06649195519350111, -0.06652072181780276, -0.06655126260783681, -0.06658314625181957, -0.06661593200868828, -0.06664917574985259, -0.06668243587874144, -0.06671527905247847, -0.0667472856363246, -0.06677805482851022, -0.0668072094005194, -0.0668344000056547, -0.06685930901662411, -0.06688165386080153, -0.06690118982961385, -0.06691771234605458, -0.06693105868154807, -0.06694110912020414, -0.06694778757485409, -0.06695106166511815, -0.06695094227307867, -0.06694748259695527, -0.0669407767274621, -0.06693095777532655, -0.06691819558177331, -0.06690269404665686, -0.06688468811140946, -0.06686444043607472, -0.06684223781146456, -0.06681838734894123, -0.06679321249148795, -0.0667670488906408, -0.06674024019448692, -0.06671313379231017, -0.0666860765615836, -0.06665941066283017, -0.0666334694274122, -0.06660857338252288, -0.06658502645652105, -0.06656311240624249, -0.06654309150602866, -0.06652519753588357, -0.06650963510342389, -0.06649657733107742, -0.06648616393634696, -0.06647849972885451, -0.06647365354339071, -0.06647165762328346, -0.06647250746316612, -0.06647616211468671, -0.0664825449529436, -0.06649154489551937, -0.06650301806001219, -0.06651678984001501, -0.06653265737367231, -0.06655039237334559, -0.06656974427965068, -0.06659044369829058, -0.06661220607378115, -0.06663473555047157, -0.06665772896823388, -0.06668087993794855, -0.06670388294047168, -0.06672643739218387, -0.06674825162052306, -0.06676904669408798, -0.066788560053969, -0.06680654889588071, -0.06682279325640493, -0.06683709876112676, -0.06684929899760807, -0.06685925748187985, -0.06686686919336496, -0.06687206165975175, -0.06687479558021045, -0.06687506498235235]
LIMIT = 50
START = 80
plt.plot(np.arange(LIMIT) + START, y[START:START+LIMIT], color='C0', label='aPGD')

ax = plt.subplot(111)
ax.set_xlabel('Number of iterations')
ax.set_ylabel(r'$ \frac{|f(x_k) - f^{*}|}{|f^{*}}$')
ax.set_title('Relative error as a function of number of iterations \n for a 10 x 28 instance')
ax.legend()
ax.grid('on')
plt.show()
