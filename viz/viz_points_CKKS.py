import matplotlib.pyplot as plt
import numpy as np

OPT_X = [1]
OPT_Y = [0]
plt.scatter(OPT_X, OPT_Y, color='orange', marker='*', s=500, label='optimal solution')  # plot optimal solution as a star
# Generate a range of x values
x = np.linspace(0, 1, 400)
# Compute the corresponding y values
y = -x + 1
plt.plot(x, y, label='Ax = b')

alpha = 0.1

CKKS = [(0.4996909665772324, 0.5009471394037934), (0.49884160693813884, 0.5049445257617534), (0.49225011583778555, 0.5053890573371702), (0.48950946953882657, 0.5080361927356644), (0.48602192216501744, 0.5155222850347275), (0.4792502293080273, 0.5204782487914624), (0.47402652320079564, 0.5271429233864817), (0.46873795977650384, 0.5285764630225411), (0.46737159376219944, 0.5311676300462892), (0.46833392684030317, 0.5349745963184354), (0.46459192748162864, 0.5341284966964837), (0.46431826417555877, 0.5343776359239452), (0.4652235559364918, 0.5350146313602171), (0.46670445246437453, 0.5349232729547132), (0.4655182664563996, 0.5339589276290806), (0.46604588502503996, 0.5362545388193267), (0.46592467417504246, 0.5344663639717726), (0.4654497348200177, 0.5331690627718614), (0.4633201339928643, 0.5339750277713025), (0.4645989987914915, 0.5361620654372498), (0.46445214537476726, 0.5362949548629505), (0.4637941711088445, 0.5372375300449456), (0.46419801700912766, 0.5380596304653119), (0.46373288775369886, 0.5377905778876051), (0.4645655939574856, 0.5356476322315193), (0.4657890935587483, 0.5339185002360094), (0.4677114416345925, 0.5335829517894339), (0.46776130908403313, 0.5336946291799942), (0.4667531656806656, 0.5341937877618558), (0.46495600191255826, 0.5357959760276947), (0.4630239130944573, 0.5361936436901367), (0.4615689931781322, 0.5361108114955392), (0.4623253975638729, 0.5382986395361185), (0.46296519718141216, 0.5416162720465353), (0.45856147590665775, 0.5413657045774897), (0.45555105034223436, 0.5446390700299447), (0.45095655258356077, 0.5491298937475284), (0.44550489869093396, 0.5557610290765521), (0.43735200725933504, 0.5628809270594273), (0.43119870695266, 0.5692735067177701), (0.4236940698623609, 0.5759293451421124), (0.4161191818458394, 0.581606939519141), (0.4103190249996917, 0.5918850537709741), (0.4004639051327043, 0.6002400980144469), (0.39124605036850063, 0.608369340971795), (0.37986771943058684, 0.6172398196733726), (0.36905884196507904, 0.6262736095855296), (0.36191686739517015, 0.6383502988061945), (0.35126597353999994, 0.6458770032652593), (0.3416736392572513, 0.6578005273730401), (0.3332965145514097, 0.6697458654424105), (0.3196464419083911, 0.6784142771587444), (0.30956582478397604, 0.6905177370254183), (0.300380356910747, 0.7019200288863497), (0.2894242487503038, 0.7101587061034196), (0.2783946278813519, 0.7223439267862222), (0.2689223279232391, 0.7318384511012193), (0.25886494560622325, 0.7415086909727238), (0.2478580394259909, 0.7510318105727569), (0.24011778247505797, 0.7612723206999378), (0.22901864328732038, 0.7702636560457341), (0.21721923008024677, 0.780875697968592), (0.20567812223976356, 0.7944558815403399), (0.19374211954030304, 0.8069135445757756), (0.1828433850089421, 0.8193863536795778), (0.17061238478866284, 0.830406486293558), (0.15717963650612618, 0.8426485241581032), (0.14554849949962478, 0.8544090121268233), (0.1345660000468432, 0.864773455035712), (0.1247154180697809, 0.8766382691736956), (0.11373843252878778, 0.8896169190462029), (0.09831192565768836, 0.9030001477579422), (0.08420158918504171, 0.9204706610001946), (0.06401872598735348, 0.935778718551493), (0.04650108449064467, 0.9548242834538514), (0.026849601635495282, 0.973676357599578), (0.008832476296280355, 0.9915120850244695), (0.0, 1.0112220760149004), (0.0, 1.0200127441506632), (0.0, 1.0149211776656208), (0.0, 1.0048063483247613), (0.0028192248384476017, 0.9982842404077646), (0.005015251787261029, 0.9922459820883833), (0.009881285435268049, 0.9875207258845576), (0.015711684635239895, 0.9833799025275567), (0.01976584404727598, 0.9794324341631288), (0.02322402418737158, 0.97678621773151), (0.026918983149353124, 0.9727164937372109), (0.0293015986997961, 0.9661527149739244), (0.036737239887854635, 0.9650304650778249), (0.039050781657307965, 0.96017654170864), (0.04282654458176626, 0.9558838023299805), (0.046513940735850585, 0.9531308884110935), (0.05156791788757349, 0.9519112967656679), (0.05369701897680704, 0.9472560318949177), (0.055584447890375456, 0.9411845586012508), (0.060123252071595974, 0.9387329925409591), (0.0653710002681481, 0.9365447529230219), (0.06862784041399336, 0.9319494346674644), (0.07223692688721234, 0.9267949837017941), (0.07537956511568145, 0.9221826799815067), (0.0812298742946996, 0.9181321677358623), (0.08410144337920807, 0.9148303972321908), (0.08999795886444645, 0.9145764840547097), (0.08983910052737774, 0.9091231686452456), (0.09312088301410709, 0.9060248619702901), (0.09695321952826103, 0.9041994358053677), (0.09689369671674353, 0.9035015207121033), (0.09630117033433755, 0.9021280868316703), (0.09959791253218928, 0.9042466007995346), (0.09739063433366474, 0.9027166256625574), (0.0957127837713839, 0.9010542158843989), (0.09583466894855504, 0.902593465255977), (0.09284163466638301, 0.9041796770287227), (0.08936262417279343, 0.9080385857246936), (0.08822684651441133, 0.9139223315997456), (0.0804860748281188, 0.9165174023753692), (0.07917741400429665, 0.9230097456605105), (0.07412296188739226, 0.9262839486251769), (0.06941420801031938, 0.9322781508303118), (0.061262055058677704, 0.9382857964945668), (0.05332622841000654, 0.9459667980491144), (0.04502751233686082, 0.9530150603324695), (0.036760105585211755, 0.962326799737727), (0.02889089118291862, 0.97161412511015), (0.02004152459812931, 0.9798687940747842), (0.008787778095296414, 0.9874928559256798), (0.002062825812703789, 0.9981920453783892), (0.0, 1.0082799645904876), (0.0, 1.0115013481445534), (0.0, 1.0068301502782628), (0.0, 1.0026644063809387), (0.0, 1.0018752453890722), (0.0, 1.0039387563860842), (0.0, 1.0027211401352438), (0.0, 1.0000742826705689), (0.0, 0.9998265904334495), (0.0002936129161523432, 0.9979367779914237), (0.004827948020648285, 0.9980669979959892), (0.004330099185776266, 0.9948092565411429), (0.007408165441931175, 0.997484898910889), (0.003451079321974129, 0.9963054335592245), (0.0016076437494852713, 0.9978845344440915), (0.0012800933868431473, 0.9991318225024844), (0.0014462447309911118, 1.0006790316046452), (0.0, 1.0011252305173457), (0.0004539723278243195, 1.000607558531497), (0.0, 0.9978492762592196), (0.0019071120774937721, 0.9987177100545078), (0.0009252327901648862, 0.9977777328589742), (0.0, 1.000532376325075), (0.0010958220618813748, 1.003248837939337), (0.0, 1.002548939274995), (0.0, 1.0008847919582067), (0.0011533924333706773, 1.001892794762097), (0.0, 0.9989821560887625), (0.001213998705200773, 0.9972863926060829), (0.004332217330748886, 0.9989502957975948), (0.0018649980038511027, 0.9967755061946272), (0.0009878275225206298, 0.9993798597849718), (0.0007430261453506027, 1.0016288346282007), (0.0, 1.0010375129654694), (0.0, 1.001289405849184), (0.0002266098492743608, 1.000435153602258), (0.0, 1.0010451094389035), (0.0, 1.000425720578824), (0.003236004520184959, 1.0006728754523218), (0.004108691035411021, 0.9955630029172632), (0.008547738849873997, 0.9921723427239305), (0.011256292000397565, 0.9886947398299853), (0.01376710967969108, 0.9837485884298933), (0.019808025530224142, 0.98196375162065), (0.020173264765525195, 0.9772379604576696), (0.02284973276791551, 0.974600286993373), (0.026585977205083627, 0.9721774808630987), (0.029099852257355372, 0.9687429241848085), (0.03470441489408672, 0.9671439497454414), (0.037075422134896396, 0.9642443303394955), (0.03901721349579631, 0.9613756134639765), (0.04020178196647281, 0.9592545978020719), (0.044377036157191435, 0.9590143107068938), (0.04475958831066604, 0.9561252171839455), (0.04626110277012617, 0.9564726887806069), (0.0435305725062702, 0.9531038548091042), (0.04640468661124266, 0.956277647505047), (0.04420884608658958, 0.9547422625665758), (0.04458488915486629, 0.9549310977320861), (0.04570987290837296, 0.9564061799389049), (0.0450878912663054, 0.9543159828947742), (0.04723942615595668, 0.9556202501069512), (0.04621925969794735, 0.953782002977276), (0.04509465250781588, 0.9553526650707364), (0.0432065979636145, 0.9585560714438525), (0.04223645994630161, 0.9597095691393092), (0.041595751324885785, 0.9593974636268194), (0.041704940058120275, 0.9604392625641223), (0.03824643271069664, 0.9589315089987863), (0.03779658870176728, 0.9607033094957064), (0.03640651668263678, 0.9622120818216761), (0.033523986573837775, 0.9633359983828973), (0.03356257069856394, 0.9682552628133394), (0.030903127663982392, 0.9729994960287327), (0.02477038993736592, 0.9746698909825272), (0.019849052501310714, 0.9790005395027978), (0.014299305782316335, 0.983393384962677), (0.010736460953340087, 0.9895714174542973), (0.0038077840271630815, 0.9930465773292123), (0.0, 1.0003130613607463), (0.0, 1.007285789204878), (0.0, 1.0068449757301146), (0.0, 1.0045642086440354), (0.0, 1.0013533137495398), (0.0, 0.9987630540102259), (0.0037880289831769896, 0.99983443833447), (0.0024998722768013316, 0.9999484314490796), (0.0001174101892640301, 1.0012151744399809), (0.0, 1.0034123091058516), (0.0, 1.0052486496866138), (0.0, 1.0042463512660673), (0.0, 1.0005665705137037), (0.0012243228468296536, 0.999759183419238), (0.00020282275793476624, 0.9981423551061762), (0.0, 0.9986459352251693), (0.0018856689341859897, 1.0002571502694726), (0.0, 0.997868779759667), (0.0, 0.9984314185845031), (0.002117902156898757, 0.9992533772809636), (0.0006565481717870094, 0.9997620675536729), (0.0, 0.9996695878923137), (0.0005972206406542312, 1.0002530756855468), (0.0, 0.9996515328881606), (0.00066523559381136, 1.0009013489954002), (0.0, 0.9981078972744927), (0.00030570692166126845, 0.9977845126204175), (0.0, 0.9980284554249123), (0.0, 0.9988643249212984), (0.00042235971100579734, 0.998823008761988), (0.0004214068708426144, 0.9988781602142095), (0.001018478512523088, 0.9997530122260964), (0.0, 1.001569830245402), (0.0, 1.002645171997453), (0.0, 1.0037582393911342), (0.0, 1.0051169382326954), (0.0, 1.0038185289595063), (0.0, 1.000390163677216), (0.0012676315588420399, 0.9970306216578474), (0.005566876774791867, 0.9976286717261881), (0.004102167821905444, 0.9978700931646816), (0.0025593154471778047, 0.9990367357219584), (0.0, 1.0022142012446449), (0.0, 1.0043194504136084), (0.0, 1.0041114009055403), (0.0, 1.0002340409589305), (0.0020439935115228918, 0.9980456565873467), (0.004932419562082923, 0.9985539708242861), (0.005077005274832421, 0.9953486714664982), (0.0048272363497323285, 0.9925252018607479), (0.008120568621177953, 0.9929167872742714), (0.008732424432027706, 0.989400491352192), (0.01246762080048806, 0.9890349314870716), (0.014893607363880254, 0.9867912490890322), (0.013942332201327443, 0.9828664021148815), (0.013530790054520112, 0.9818482448037892), (0.015478144855366652, 0.9831259714675257), (0.015498870626012611, 0.9826553794146331), (0.016157199428526066, 0.9823691460921226), (0.01629990212206337, 0.9839678233384607), (0.01720120893992855, 0.9859526132313897), (0.014196638847158057, 0.9850166876162264), (0.01174725884191037, 0.9875854795865842), (0.006494235292688743, 0.9904101295860761), (0.004192979827799214, 0.9966825038747581), (0.0, 1.00024099023787), (0.0, 1.0070871462407645), (0.0, 1.007162063348708), (0.0, 1.0060797134041084), (0.0, 1.00490271613054), (0.0, 1.0033112323476776), (0.0, 1.0017430502486089), (0.0, 0.9994764871619753), (0.0, 1.000313872935801), (0.0, 1.0013360979046695), (0.0, 1.0007158151935671), (0.0, 1.0018724420751364), (0.0, 1.0028251288227552), (0.0, 1.0025042488743063), (0.0, 1.0031449495198708), (0.0, 1.0020613818994415), (0.0, 1.0000055462204818), (0.00214440143572374, 0.9991103673883773), (0.00473033219660596, 0.9941019192152679), (0.009911140825473895, 0.9939427449766186)]

selected = CKKS
x = [x[1] for x in selected]
y = [x[0] for x in selected]

plt.scatter(x, y, linestyle='-', color='C2', label=r'CKKS')

# show the final plot
ax = plt.subplot(111)
ax.set_xlabel(r'$x_1$')
ax.set_ylabel(r'$x_2$')
ax.set_title(fr'Convergence pattern for CKKS')
ax.legend()
plt.xlim([.999, 1.005])
plt.ylim([-.01, .01])
ax.grid('on')
plt.show()
